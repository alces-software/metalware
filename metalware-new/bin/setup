#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

# Install RVM.
gpg2 --keyserver hkp://pgp.mit.edu --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3
curl -sSL https://get.rvm.io | bash -s stable
# XXX Need to log out and in again here for script to work on first run.
rvm rvmrc warning ignore allGemfiles

# Required for rugged gem.
yum install cmake -y

# Required for pcap gem.
yum install libpcap libpcap-devel -y

# Required for `nodeattr`.
yum install genders -y

# Install Ruby and gems.
rvm install ruby-2.4.1
cd .. && cd -  # Let RVM automatically use correct Ruby for dir.
# XXX Need to log out and in again here for script to work on first run.
gem install bundler
bundle install
